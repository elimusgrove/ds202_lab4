```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(stringr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readxl)

defense = read_excel('cyclonesFootball2019.xlsx', sheet='Defensive')
offense = read_excel('cyclonesFootball2019.xlsx', sheet='Offensive')
bio = read_excel('cyclonesFootball2019.xlsx', sheet='Biography')
```
<<<<<<< HEAD
=======

---
title: Team Work file
author: Aaron Jencks, Eli Musgrove
date: 3/19/2020
output: html_document
---

```{r}
str(defense)
str(offense)
str(bio)
```

## Part 1: Cleaning

1. The player names and opponent names are factors

	```{r}
	total_names_list = unique(c(defense$Name, offense$Name, bio$Name))
	defense$Name = factor(defense$Name, levels=total_names_list)
	offense$Name = factor(offense$Name, levels=total_names_list)
	bio$Name = factor(bio$Name, levels=total_names_list)

	total_opponent_names_list = unique(c(defense$Opponent_Opponent, offense$Opponent_Opponent))
	defense$Opponent_Opponent = factor(defense$Opponent_Opponent, levels=total_opponent_names_list)
	offense$Opponent_Opponent = factor(offense$Opponent_Opponent, levels=total_opponent_names_list)
	```

2. All offensive and defensive statistics are numerical. The Weight column in biography is also numeric.

	```{r}
	defense = defense %>% mutate_at(colnames(defense)[2:10], as.numeric)
	offense = offense %>% mutate_at(colnames(offense)[2:11], as.numeric)
	bio$Weight = as.numeric(bio$Weight)
	```

3. Change the Height column in biography into numeric.

	```{r}
	bio = bio %>% mutate(height_feet = (function(element) {

					# You'll need the stringr package for these methods, 
					# they are used to splice the feet and inches parts of the Height
					index = (element %>% str_locate("-"))[,1]
					result = as.numeric(element %>% str_sub(rep(1, length(index)), index - 1))
					return(result)

				})(Height),

			     Height = (function(elements) {

					# Converts feet into inches, and then adds the inches
					index = (elements %>% str_locate("-"))[,1]
					feet = as.numeric(elements %>% str_sub(1, index - 1)) * 12
					inches = as.numeric(elements %>% str_sub(index + 1, rep(length(elements), length(elements))))
					result = feet + inches
					return(result)

				})(Height))
	```

## Part 2: Tidying

### Part 1

1. Reformat the defClean data frame into tidy format using `pivot_longer`. The type of statistic (Tackles_Solo, Tackles_ASST, etc) is added as a new key column named Statistic.
2. Create a histogram for each defensive statistic. Use `facet_wrap` to draw all histograms in a single plot. What defensive skills are rare?
3. Did ISU have better defense against West Virginia or Kansas State? Answer this question by creating a scatterplot with x-axis being the number of solo tackles against West Virginia, and y-axis being that against Kansas State. A large number of solor tackles indicates a good defense.

### Part 2

1. Separate the Hometown column into two columns, namely the city and the state. Print he first few rows of these two columns.
2. How many players are there from each state?

## Part 3: Joining data frames

1. Find where do the offensive players come from by joining the offensive data and player biography data appropriately.

	```{r}

	hometowns = full_join(offense, bio, by="Name") %>% select(Name, Hometown) %>% distinct()
	head(hometowns)

	```

2. Is there a relationship between the weight of a player and the receiving yarsd (`Receiving_YDS`)?

	```{r}

	```

3. How do the performance of quarterback Brock Purdy relate to the performance fo the ISU team?
4. Explore more. You may in addition explore the 2018 data (see slides). Raise a question that can be answered only by looking at two or more data frames. Then answer that question.
